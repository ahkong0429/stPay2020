# stPay2020
2020最新跑分聚合支付系统

技术架构基于：
NodeJs, eggjs, mysql, typeorm, redis, jwt, typescript, vue, socket.io

系统功能说明：
基础功能
1.完整的权限管理，基于RBAC，可控制到单个action
2.部门设置，管理不同的角色
3.码商系统，详见下方内置系统功能说明。
4.代理系统，详见下方内置系统功能说明。
5.商户系统，详见下方内置系统功能说明。
6.系统性能监控

内置系统功能说明：
码商系统
3.1码商管理（用户信息，二维码管理，通道配置，佣金比例设置，推广链接，充值提现，上下分）
3.2通道管理（每个通道可单独设置费率，单日限额，单日限次，单笔限额）
3.3商户管理（商户开户，商户通道配置，商户上下分，商户绑定安全ip，所有商户对接接口都会验证ip来源确保系统安全性）
3.4订单管理（支持系统支付，补单，补发回调，同时支持实时订单消息通知，包括新订单，已支付订单，回调失败订单，某个通道码量不足的通知等，不需要手动刷新，全部实时通知）
3.5充值、提现（支持自定义渠道，充提方式，充提单笔限额，单日限次，单日限额等）（所有订单需要人工审核，支付，确认，系统会记录每一笔的操作人，操作时间，操作备注，每一笔资金都可查到源头）
3.6银行卡（码商绑定的银行卡，可绑定多个，会员不可修改）
3.7推广链接（所有人注册的时候会自动成为代理，每个会员都可以发展下级，下级的佣金比例不可高于自己，每个下级的每一笔完成订单都会向上无限返佣，直到总代理，无限层级，每个会员可以单独设置多个推广链接，推广链接可绑定不同返佣比例的通道，代理可随时修改下级的通道返佣比例）
3.8资金日志（记录所有资金流水明细）
3.9任务管理（管理所有计划任务，可视化界面管理，可编辑的定时任务，完全支持高并发）
3.10参数配置（系统参数的配置，读写redis缓存，超高的读写速度，保证系统的流畅运行）
3.11财务统计（代理统计，商户统计）


代理系统
4.1代理系统继承码商系统的码商列表，可见自己的直推下级列表，可给下级开户并配置通道

商户系统
5.1商户系统继承码商系统的商户管理，订单管理，资金日志，不同在于商户只能看到自己的订单和资金日志，同时每一个商户都可继续给代理商户开户，单独负责代理商户的接入，可无限发展层级

其他功能说明：
上传空间：阿里云oss
短信网关预留了功能，暂未接入，默认验证码固定1234

系统可配置项：
短信ip限制次数
前端域名
单码是否可循环接单
提现手续费(按提现总额百分比)
提现手续费(每笔固定额)
系统佣金加成：可配合计划任务实现某个时间段的佣金加成
系统支付网关域名
金额减免规则（递增或递减
订单匹配规则（内置，目前只有按顺序轮流规则
是否启用同城派单（目前收集了ip信息，暂未开发功能
单码空单多少次自动下线
未匹配的订单多久取消(单位：秒)
已匹配的订单多久超时(单位：秒)
新增收款码的默认状态

所有资金操作都会加入消息队列，保证高并发下金额的准确，后台可查看消息队列的执行状况，
系统内置了性能监控，30秒收集一次服务器信息，可自由调整或开关
每一条请求都有日志可查，可设置保留日志天数，默认7天
前端、后台实现了socket消息推送服务，大部分时候不需要手动去刷新页面，一改市面上传统的轮询方式，大大提高系统并发性能，实现“秒出码”

商务合作 ahkong0429@gmail.com
